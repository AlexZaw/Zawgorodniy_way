import{setPhoneInputListener,setEmailInputListener}from"./form-check.min.js";import{fillForm,onEmptyPhoneFocus}from"./form-autofill.min.js";import{onFormSubmit}from"./form-submit.min.js";import{isEscKey}from"./utils.min.js";const buyButtons=document.querySelectorAll(".buy-tour"),formPopupTemplate=document.querySelector("#form-popup").content.querySelector(".modal"),successPopupTemplate=document.querySelector("#success-message").content.querySelector(".success-message"),isPopupForm=()=>document.querySelector(".modal"),onClosePopup=e=>{const o=document.querySelector(".active-popup");(isEscKey(e)||e.target.classList.contains("close-popup"))&&closePopup(o)};function closePopup(e){e.remove(),document.removeEventListener("keydown",onClosePopup)}const closePopupListener=e=>{document.addEventListener("keydown",onClosePopup),e.addEventListener("click",onClosePopup)},showPopup=e=>{const o=e.cloneNode(!0);o.classList.add("active-popup");const t=o.querySelector(".modal__phone");if(document.body.insertAdjacentElement("beforeend",o),t){const e=o.querySelector(".modal__form");e.querySelector('[type="submit"]').addEventListener("click",onFormSubmit),setPhoneInputListener(e),setEmailInputListener(e),onEmptyPhoneFocus(e),t.focus(),fillForm(e)}closePopupListener(o)},showForm=e=>{e.preventDefault(),showPopup(formPopupTemplate)},onBuyTourButtonsClick=()=>{buyButtons.forEach((e=>e.addEventListener("click",showForm)))};export{onBuyTourButtonsClick,closePopup,showPopup,isPopupForm,successPopupTemplate};