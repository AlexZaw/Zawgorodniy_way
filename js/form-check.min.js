import{showPopup,successPopupTemplate,closePopup,isPopupForm}from"./modal.min.js";const phoneFieldLength=12,phoneRegular=/^\+\d{11}/,emailRegular=/^([a-zA-Z0-9_\-.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,showErrorTooltip=e=>{[...e.querySelectorAll("input")].forEach((e=>{!1===e.validity.valid?e.closest(".error-data").classList.add("error-data--show"):e.closest(".error-data").classList.remove("error-data--show")}))},checkPhoneField=e=>{const t=e.value.length;t<12?e.setCustomValidity(`Введите еще ${12-t}\n    симв.`):phoneRegular.test(e.value)?t>12?e.setCustomValidity(`Удалите лишние ${t-12}\n    симв.`):(e.setCustomValidity(""),e.closest(".error-data").classList.remove("error-data--show")):e.setCustomValidity("Номер телефона должен быть вида: +712345678901"),e.reportValidity()},checkEmailField=e=>{!emailRegular.test(e.value)&&e.value.length?e.setCustomValidity("Введите корректный E-mail"):(e.setCustomValidity(""),e.closest(".error-data").classList.remove("error-data--show")),e.reportValidity()},onEmailInput=e=>{const t=e.target;checkEmailField(t)},onPhoneInput=e=>{const t=e.target;checkPhoneField(t)},checkForm=e=>{const t=e.querySelectorAll("input"),o=e["user-phone"],s=e["user-email"];if(checkPhoneField(o),checkEmailField(s),showErrorTooltip(e),[...t].every((e=>e.validity.valid))){const e=isPopupForm();e&&closePopup(e),showPopup(successPopupTemplate)}},setPhoneInputListener=e=>{e["user-phone"].addEventListener("input",onPhoneInput)},setEmailInputListener=e=>{e["user-email"].addEventListener("input",onEmailInput)};export{setPhoneInputListener,checkForm,onPhoneInput,setEmailInputListener};